{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk="}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo="}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M="}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":74,"index":74}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8="}},{"name":"../services/dayCycle","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":75},"end":{"line":9,"column":30,"index":251}},{"start":{"line":2,"column":0,"index":75},"end":{"line":9,"column":30,"index":251}},{"start":{"line":2,"column":0,"index":75},"end":{"line":9,"column":30,"index":251}},{"start":{"line":2,"column":0,"index":75},"end":{"line":9,"column":30,"index":251}}],"key":"OSLOb09brS6UbgF2CSgs1O5njUE=","isOptional":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useDayCycle = useDayCycle;\n  var _asyncToGenerator2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\"));\n  var _slicedToArray2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/slicedToArray\"));\n  var _react = _$$_REQUIRE(_dependencyMap[3], \"react\");\n  function useDayCycle(userId) {\n    var _useState = (0, _react.useState)(null),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n    var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n    var _useState5 = (0, _react.useState)(null),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      error = _useState6[0],\n      setError = _useState6[1];\n    var autoEndTimer = (0, _react.useRef)(null);\n    var status = (0, _react.useMemo)(function () {\n      if (!(state != null && state.startTime)) return 'not-started';\n      if (state.endTime) return 'completed';\n      return 'in-progress';\n    }, [state]);\n    var refresh = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator2.default)(function* () {\n      if (!userId) {\n        setState(null);\n        return;\n      }\n      setLoading(true);\n      setError(null);\n      try {\n        var _yield$loadDayCycle = yield (0, _$$_REQUIRE(_dependencyMap[4], \"../services/dayCycle\").loadDayCycle)(userId),\n          current = _yield$loadDayCycle.state;\n        setState(current);\n      } catch (err) {\n        setError((err == null ? void 0 : err.message) || 'Unable to load day state.');\n      } finally {\n        setLoading(false);\n      }\n    }), [userId]);\n    (0, _react.useEffect)(function () {\n      refresh();\n    }, [refresh]);\n    var startDay = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator2.default)(function* () {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!userId) throw new Error('Missing user id');\n      setLoading(true);\n      setError(null);\n      try {\n        var next = yield (0, _$$_REQUIRE(_dependencyMap[4], \"../services/dayCycle\").startDay)(userId, options);\n        setState(next);\n        return next;\n      } catch (err) {\n        setError((err == null ? void 0 : err.message) || 'Unable to start day.');\n        throw err;\n      } finally {\n        setLoading(false);\n      }\n    }), [userId]);\n    var endDay = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator2.default)(function* () {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!userId) throw new Error('Missing user id');\n      setLoading(true);\n      setError(null);\n      try {\n        var next = yield (0, _$$_REQUIRE(_dependencyMap[4], \"../services/dayCycle\").endDay)(userId, options);\n        setState(next);\n        return next;\n      } catch (err) {\n        setError((err == null ? void 0 : err.message) || 'Unable to end day.');\n        throw err;\n      } finally {\n        setLoading(false);\n      }\n    }), [userId]);\n    (0, _react.useEffect)(function () {\n      if (autoEndTimer.current) {\n        clearTimeout(autoEndTimer.current);\n        autoEndTimer.current = null;\n      }\n      if (status === 'in-progress') {\n        var ms = (0, _$$_REQUIRE(_dependencyMap[4], \"../services/dayCycle\").msUntilColomboEndOfDay)();\n        autoEndTimer.current = setTimeout(function () {\n          endDay({\n            gpsStatus: false,\n            latitude: 0,\n            longitude: 0\n          }).catch(function () {});\n        }, ms);\n      }\n      return function () {\n        if (autoEndTimer.current) {\n          clearTimeout(autoEndTimer.current);\n          autoEndTimer.current = null;\n        }\n      };\n    }, [status, endDay]);\n    return {\n      state: state,\n      status: status,\n      loading: loading,\n      error: error,\n      refresh: refresh,\n      startDay: startDay,\n      endDay: endDay\n    };\n  }\n});","lineCount":113,"map":[[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"_$$_REQUIRE"],[9,26,1,0],[9,27,1,0,"_dependencyMap"],[9,41,1,0],[10,2,13,7],[10,11,13,16,"useDayCycle"],[10,22,13,27,"useDayCycle"],[10,23,13,28,"userId"],[10,29,13,43],[10,31,13,45],[11,4,14,2],[11,8,14,2,"_useState"],[11,17,14,2],[11,20,14,28],[11,24,14,28,"useState"],[11,39,14,36],[11,41,14,59],[11,45,14,63],[11,46,14,64],[12,6,14,64,"_useState2"],[12,16,14,64],[12,23,14,64,"_slicedToArray2"],[12,38,14,64],[12,39,14,64,"default"],[12,46,14,64],[12,48,14,64,"_useState"],[12,57,14,64],[13,6,14,9,"state"],[13,11,14,14],[13,14,14,14,"_useState2"],[13,24,14,14],[14,6,14,16,"setState"],[14,14,14,24],[14,17,14,24,"_useState2"],[14,27,14,24],[15,4,15,2],[15,8,15,2,"_useState3"],[15,18,15,2],[15,21,15,32],[15,25,15,32,"useState"],[15,40,15,40],[15,42,15,41],[15,47,15,46],[15,48,15,47],[16,6,15,47,"_useState4"],[16,16,15,47],[16,23,15,47,"_slicedToArray2"],[16,38,15,47],[16,39,15,47,"default"],[16,46,15,47],[16,48,15,47,"_useState3"],[16,58,15,47],[17,6,15,9,"loading"],[17,13,15,16],[17,16,15,16,"_useState4"],[17,26,15,16],[18,6,15,18,"setLoading"],[18,16,15,28],[18,19,15,28,"_useState4"],[18,29,15,28],[19,4,16,2],[19,8,16,2,"_useState5"],[19,18,16,2],[19,21,16,28],[19,25,16,28,"useState"],[19,40,16,36],[19,42,16,52],[19,46,16,56],[19,47,16,57],[20,6,16,57,"_useState6"],[20,16,16,57],[20,23,16,57,"_slicedToArray2"],[20,38,16,57],[20,39,16,57,"default"],[20,46,16,57],[20,48,16,57,"_useState5"],[20,58,16,57],[21,6,16,9,"error"],[21,11,16,14],[21,14,16,14,"_useState6"],[21,24,16,14],[22,6,16,16,"setError"],[22,14,16,24],[22,17,16,24,"_useState6"],[22,27,16,24],[23,4,17,2],[23,8,17,8,"autoEndTimer"],[23,20,17,20],[23,23,17,23],[23,27,17,23,"useRef"],[23,40,17,29],[23,42,17,53],[23,46,17,57],[23,47,17,58],[24,4,19,2],[24,8,19,8,"status"],[24,14,19,25],[24,17,19,28],[24,21,19,28,"useMemo"],[24,35,19,35],[24,37,19,36],[24,49,19,42],[25,6,20,4],[25,10,20,8],[25,12,20,9,"state"],[25,17,20,14],[25,29,20,9,"state"],[25,34,20,14],[25,35,20,16,"startTime"],[25,44,20,25],[25,47,20,27],[25,54,20,34],[25,67,20,47],[26,6,21,4],[26,10,21,8,"state"],[26,15,21,13],[26,16,21,14,"endTime"],[26,23,21,21],[26,25,21,23],[26,32,21,30],[26,43,21,41],[27,6,22,4],[27,13,22,11],[27,26,22,24],[28,4,23,2],[28,5,23,3],[28,7,23,5],[28,8,23,6,"state"],[28,13,23,11],[28,14,23,12],[28,15,23,13],[29,4,25,2],[29,8,25,8,"refresh"],[29,15,25,15],[29,18,25,18],[29,22,25,18,"useCallback"],[29,40,25,29],[29,59,25,29,"_asyncToGenerator2"],[29,77,25,29],[29,78,25,29,"default"],[29,85,25,29],[29,87,25,30],[29,100,25,42],[30,6,26,4],[30,10,26,8],[30,11,26,9,"userId"],[30,17,26,15],[30,19,26,17],[31,8,27,6,"setState"],[31,16,27,14],[31,17,27,15],[31,21,27,19],[31,22,27,20],[32,8,28,6],[33,6,29,4],[34,6,30,4,"setLoading"],[34,16,30,14],[34,17,30,15],[34,21,30,19],[34,22,30,20],[35,6,31,4,"setError"],[35,14,31,12],[35,15,31,13],[35,19,31,17],[35,20,31,18],[36,6,32,4],[36,10,32,8],[37,8,33,6],[37,12,33,6,"_yield$loadDayCycle"],[37,31,33,6],[37,40,33,39],[37,44,33,39,"loadDayCycle"],[37,74,33,39],[37,75,33,39,"loadDayCycle"],[37,111,33,51],[37,113,33,52,"userId"],[37,119,33,58],[37,120,33,59],[38,10,33,21,"current"],[38,17,33,28],[38,20,33,28,"_yield$loadDayCycle"],[38,39,33,28],[38,40,33,14,"state"],[38,45,33,19],[39,8,34,6,"setState"],[39,16,34,14],[39,17,34,15,"current"],[39,24,34,22],[39,25,34,23],[40,6,35,4],[40,7,35,5],[40,8,35,6],[40,15,35,13,"err"],[40,18,35,21],[40,20,35,23],[41,8,36,6,"setError"],[41,16,36,14],[41,17,36,15],[41,18,36,15,"err"],[41,21,36,18],[41,41,36,15,"err"],[41,44,36,18],[41,45,36,20,"message"],[41,52,36,27],[41,57,36,31],[41,84,36,58],[41,85,36,59],[42,6,37,4],[42,7,37,5],[42,16,37,14],[43,8,38,6,"setLoading"],[43,18,38,16],[43,19,38,17],[43,24,38,22],[43,25,38,23],[44,6,39,4],[45,4,40,2],[45,5,40,3],[45,8,40,5],[45,9,40,6,"userId"],[45,15,40,12],[45,16,40,13],[45,17,40,14],[46,4,42,2],[46,8,42,2,"useEffect"],[46,24,42,11],[46,26,42,12],[46,38,42,18],[47,6,43,4,"refresh"],[47,13,43,11],[47,14,43,12],[47,15,43,13],[48,4,44,2],[48,5,44,3],[48,7,44,5],[48,8,44,6,"refresh"],[48,15,44,13],[48,16,44,14],[48,17,44,15],[49,4,46,2],[49,8,46,8,"startDay"],[49,16,46,16],[49,19,46,19],[49,23,46,19,"useCallback"],[49,41,46,30],[49,60,46,30,"_asyncToGenerator2"],[49,78,46,30],[49,79,46,30,"default"],[49,86,46,30],[49,88,46,31],[49,101,46,73],[50,6,46,73],[50,10,46,38,"options"],[50,17,46,63],[50,20,46,63,"arguments"],[50,29,46,63],[50,30,46,63,"length"],[50,36,46,63],[50,44,46,63,"arguments"],[50,53,46,63],[50,61,46,63,"undefined"],[50,70,46,63],[50,73,46,63,"arguments"],[50,82,46,63],[50,88,46,66],[50,89,46,67],[50,90,46,68],[51,6,47,4],[51,10,47,8],[51,11,47,9,"userId"],[51,17,47,15],[51,19,47,17],[51,25,47,23],[51,29,47,27,"Error"],[51,34,47,32],[51,35,47,33],[51,52,47,50],[51,53,47,51],[52,6,48,4,"setLoading"],[52,16,48,14],[52,17,48,15],[52,21,48,19],[52,22,48,20],[53,6,49,4,"setError"],[53,14,49,12],[53,15,49,13],[53,19,49,17],[53,20,49,18],[54,6,50,4],[54,10,50,8],[55,8,51,6],[55,12,51,12,"next"],[55,16,51,16],[55,25,51,25],[55,29,51,25,"startDayService"],[55,59,51,25],[55,60,51,25,"startDayService"],[55,92,51,40],[55,94,51,41,"userId"],[55,100,51,47],[55,102,51,49,"options"],[55,109,51,56],[55,110,51,57],[56,8,52,6,"setState"],[56,16,52,14],[56,17,52,15,"next"],[56,21,52,19],[56,22,52,20],[57,8,53,6],[57,15,53,13,"next"],[57,19,53,17],[58,6,54,4],[58,7,54,5],[58,8,54,6],[58,15,54,13,"err"],[58,18,54,21],[58,20,54,23],[59,8,55,6,"setError"],[59,16,55,14],[59,17,55,15],[59,18,55,15,"err"],[59,21,55,18],[59,41,55,15,"err"],[59,44,55,18],[59,45,55,20,"message"],[59,52,55,27],[59,57,55,31],[59,79,55,53],[59,80,55,54],[60,8,56,6],[60,14,56,12,"err"],[60,17,56,15],[61,6,57,4],[61,7,57,5],[61,16,57,14],[62,8,58,6,"setLoading"],[62,18,58,16],[62,19,58,17],[62,24,58,22],[62,25,58,23],[63,6,59,4],[64,4,60,2],[64,5,60,3],[64,8,60,5],[64,9,60,6,"userId"],[64,15,60,12],[64,16,60,13],[64,17,60,14],[65,4,62,2],[65,8,62,8,"endDay"],[65,14,62,14],[65,17,62,17],[65,21,62,17,"useCallback"],[65,39,62,28],[65,58,62,28,"_asyncToGenerator2"],[65,76,62,28],[65,77,62,28,"default"],[65,84,62,28],[65,86,62,29],[65,99,62,71],[66,6,62,71],[66,10,62,36,"options"],[66,17,62,61],[66,20,62,61,"arguments"],[66,29,62,61],[66,30,62,61,"length"],[66,36,62,61],[66,44,62,61,"arguments"],[66,53,62,61],[66,61,62,61,"undefined"],[66,70,62,61],[66,73,62,61,"arguments"],[66,82,62,61],[66,88,62,64],[66,89,62,65],[66,90,62,66],[67,6,63,4],[67,10,63,8],[67,11,63,9,"userId"],[67,17,63,15],[67,19,63,17],[67,25,63,23],[67,29,63,27,"Error"],[67,34,63,32],[67,35,63,33],[67,52,63,50],[67,53,63,51],[68,6,64,4,"setLoading"],[68,16,64,14],[68,17,64,15],[68,21,64,19],[68,22,64,20],[69,6,65,4,"setError"],[69,14,65,12],[69,15,65,13],[69,19,65,17],[69,20,65,18],[70,6,66,4],[70,10,66,8],[71,8,67,6],[71,12,67,12,"next"],[71,16,67,16],[71,25,67,25],[71,29,67,25,"endDayService"],[71,59,67,25],[71,60,67,25,"endDayService"],[71,90,67,38],[71,92,67,39,"userId"],[71,98,67,45],[71,100,67,47,"options"],[71,107,67,54],[71,108,67,55],[72,8,68,6,"setState"],[72,16,68,14],[72,17,68,15,"next"],[72,21,68,19],[72,22,68,20],[73,8,69,6],[73,15,69,13,"next"],[73,19,69,17],[74,6,70,4],[74,7,70,5],[74,8,70,6],[74,15,70,13,"err"],[74,18,70,21],[74,20,70,23],[75,8,71,6,"setError"],[75,16,71,14],[75,17,71,15],[75,18,71,15,"err"],[75,21,71,18],[75,41,71,15,"err"],[75,44,71,18],[75,45,71,20,"message"],[75,52,71,27],[75,57,71,31],[75,77,71,51],[75,78,71,52],[76,8,72,6],[76,14,72,12,"err"],[76,17,72,15],[77,6,73,4],[77,7,73,5],[77,16,73,14],[78,8,74,6,"setLoading"],[78,18,74,16],[78,19,74,17],[78,24,74,22],[78,25,74,23],[79,6,75,4],[80,4,76,2],[80,5,76,3],[80,8,76,5],[80,9,76,6,"userId"],[80,15,76,12],[80,16,76,13],[80,17,76,14],[81,4,78,2],[81,8,78,2,"useEffect"],[81,24,78,11],[81,26,78,12],[81,38,78,18],[82,6,79,4],[82,10,79,8,"autoEndTimer"],[82,22,79,20],[82,23,79,21,"current"],[82,30,79,28],[82,32,79,30],[83,8,80,6,"clearTimeout"],[83,20,80,18],[83,21,80,19,"autoEndTimer"],[83,33,80,31],[83,34,80,32,"current"],[83,41,80,39],[83,42,80,40],[84,8,81,6,"autoEndTimer"],[84,20,81,18],[84,21,81,19,"current"],[84,28,81,26],[84,31,81,29],[84,35,81,33],[85,6,82,4],[86,6,83,4],[86,10,83,8,"status"],[86,16,83,14],[86,21,83,19],[86,34,83,32],[86,36,83,34],[87,8,84,6],[87,12,84,12,"ms"],[87,14,84,14],[87,17,84,17],[87,21,84,17,"msUntilColomboEndOfDay"],[87,51,84,17],[87,52,84,17,"msUntilColomboEndOfDay"],[87,98,84,39],[87,100,84,40],[87,101,84,41],[88,8,85,6,"autoEndTimer"],[88,20,85,18],[88,21,85,19,"current"],[88,28,85,26],[88,31,85,29,"setTimeout"],[88,41,85,39],[88,42,85,40],[88,54,85,46],[89,10,86,8,"endDay"],[89,16,86,14],[89,17,86,15],[90,12,86,17,"gpsStatus"],[90,21,86,26],[90,23,86,28],[90,28,86,33],[91,12,86,35,"latitude"],[91,20,86,43],[91,22,86,45],[91,23,86,46],[92,12,86,48,"longitude"],[92,21,86,57],[92,23,86,59],[93,10,86,61],[93,11,86,62],[93,12,86,63],[93,13,86,64,"catch"],[93,18,86,69],[93,19,86,70],[93,31,86,76],[93,32,86,77],[93,33,86,78],[93,34,86,79],[94,8,87,6],[94,9,87,7],[94,11,87,9,"ms"],[94,13,87,11],[94,14,87,12],[95,6,88,4],[96,6,89,4],[96,13,89,11],[96,25,89,17],[97,8,90,6],[97,12,90,10,"autoEndTimer"],[97,24,90,22],[97,25,90,23,"current"],[97,32,90,30],[97,34,90,32],[98,10,91,8,"clearTimeout"],[98,22,91,20],[98,23,91,21,"autoEndTimer"],[98,35,91,33],[98,36,91,34,"current"],[98,43,91,41],[98,44,91,42],[99,10,92,8,"autoEndTimer"],[99,22,92,20],[99,23,92,21,"current"],[99,30,92,28],[99,33,92,31],[99,37,92,35],[100,8,93,6],[101,6,94,4],[101,7,94,5],[102,4,95,2],[102,5,95,3],[102,7,95,5],[102,8,95,6,"status"],[102,14,95,12],[102,16,95,14,"endDay"],[102,22,95,20],[102,23,95,21],[102,24,95,22],[103,4,97,2],[103,11,97,9],[104,6,98,4,"state"],[104,11,98,9],[104,13,98,4,"state"],[104,18,98,9],[105,6,99,4,"status"],[105,12,99,10],[105,14,99,4,"status"],[105,20,99,10],[106,6,100,4,"loading"],[106,13,100,11],[106,15,100,4,"loading"],[106,22,100,11],[107,6,101,4,"error"],[107,11,101,9],[107,13,101,4,"error"],[107,18,101,9],[108,6,102,4,"refresh"],[108,13,102,11],[108,15,102,4,"refresh"],[108,22,102,11],[109,6,103,4,"startDay"],[109,14,103,12],[109,16,103,4,"startDay"],[109,24,103,12],[110,6,104,4,"endDay"],[110,12,104,10],[110,14,104,4,"endDay"],[111,4,105,2],[111,5,105,3],[112,2,106,0],[113,0,106,1],[113,3]],"functionMap":{"names":["<global>","useDayCycle","useMemo$argument_0","refresh","useEffect$argument_0","startDay","endDay","setTimeout$argument_0","endDay._catch$argument_0","<anonymous>"],"mappings":"AAA;OCY;oCCM;GDI;8BEE;GFe;YGE;GHE;+BIE;GJc;6BKE;GLc;YGE;wCGO;sECC,QD;OHC;WKE;KLK;GHC;CDW"}},"type":"js/module"}]}