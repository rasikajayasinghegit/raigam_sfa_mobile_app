{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk="}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo="}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M="}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8="}},{"name":"../config/appConfig","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":66,"index":132}},{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":66,"index":132}}],"key":"D1tKt2GxUEikrexdpSWjXQGIHNw="}},{"name":"../services/versionCheck","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":133},"end":{"line":3,"column":97,"index":230}}],"key":"2mBHwiLT6B/HB3xtht2C0KW7bAc="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useVersionGate = useVersionGate;\n  var _asyncToGenerator2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\"));\n  var _slicedToArray2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/slicedToArray\"));\n  var _react = _$$_REQUIRE(_dependencyMap[3], \"react\");\n  function useVersionGate() {\n    var _useState = (0, _react.useState)('loading'),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      status = _useState2[0],\n      setStatus = _useState2[1];\n    var _useState3 = (0, _react.useState)('Checking version…'),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      statusMessage = _useState4[0],\n      setStatusMessage = _useState4[1];\n    var _useState5 = (0, _react.useState)(0.12),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      progress = _useState6[0],\n      setProgress = _useState6[1];\n    var _useState7 = (0, _react.useState)({\n        version: '',\n        mandatory: false,\n        updateUrl: undefined,\n        message: ''\n      }),\n      _useState8 = (0, _slicedToArray2.default)(_useState7, 2),\n      versionInfo = _useState8[0],\n      setVersionInfo = _useState8[1];\n    var mountedRef = (0, _react.useRef)(true);\n    var ensureMinimumDelay = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2.default)(function* (startedAt) {\n        var elapsed = Date.now() - startedAt;\n        var wait = Math.max(0, _$$_REQUIRE(_dependencyMap[4], \"../config/appConfig\").MIN_LOADING_MS - elapsed);\n        if (wait > 0) {\n          yield new Promise(function (resolve) {\n            return setTimeout(resolve, wait);\n          });\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), []);\n    var runCheck = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator2.default)(function* () {\n      var startedAt = Date.now();\n      var nextStatus = 'ready';\n      var nextMessage = '';\n      var nextVersionInfo = {\n        version: '',\n        mandatory: false,\n        updateUrl: undefined,\n        message: ''\n      };\n      setStatus('loading');\n      setStatusMessage('Checking version…');\n      setProgress(0.12);\n      var outcome = yield (0, _$$_REQUIRE(_dependencyMap[5], \"../services/versionCheck\").checkVersion)();\n      if (outcome.status === 'ok') {\n        nextStatus = 'ready';\n        nextMessage = '';\n        nextVersionInfo = outcome.payload;\n      } else if (outcome.status === 'outdated') {\n        nextStatus = 'blocked';\n        nextMessage = outcome.payload.message || `A new version (${outcome.payload.version}) is required to continue.`;\n        nextVersionInfo = outcome.payload;\n      } else {\n        nextStatus = 'error';\n        nextMessage = 'Unable to verify app version right now. Please check your connection and retry.';\n      }\n      yield ensureMinimumDelay(startedAt);\n      if (!mountedRef.current) {\n        return;\n      }\n      setVersionInfo(nextVersionInfo);\n      setStatusMessage(nextMessage);\n      setStatus(nextStatus);\n      setProgress(1);\n    }), [ensureMinimumDelay]);\n    (0, _react.useEffect)(function () {\n      runCheck();\n    }, [runCheck]);\n    (0, _react.useEffect)(function () {\n      if (status !== 'loading') {\n        return;\n      }\n      var timer = setInterval(function () {\n        setProgress(function (prev) {\n          var next = prev + 0.05;\n          return next > 0.88 ? 0.88 : next;\n        });\n      }, 450);\n      return function () {\n        return clearInterval(timer);\n      };\n    }, [status]);\n    (0, _react.useEffect)(function () {\n      return function () {\n        mountedRef.current = false;\n      };\n    }, []);\n    return {\n      status: status,\n      statusMessage: statusMessage,\n      progress: progress,\n      versionInfo: versionInfo,\n      appVersion: _$$_REQUIRE(_dependencyMap[4], \"../config/appConfig\").APP_VERSION,\n      retry: runCheck\n    };\n  }\n});","lineCount":113,"map":[[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"_$$_REQUIRE"],[9,26,1,0],[9,27,1,0,"_dependencyMap"],[9,41,1,0],[10,2,7,7],[10,11,7,16,"useVersionGate"],[10,25,7,30,"useVersionGate"],[10,26,7,30],[10,28,7,33],[11,4,8,2],[11,8,8,2,"_useState"],[11,17,8,2],[11,20,8,30],[11,24,8,30,"useState"],[11,39,8,38],[11,41,8,51],[11,50,8,60],[11,51,8,61],[12,6,8,61,"_useState2"],[12,16,8,61],[12,23,8,61,"_slicedToArray2"],[12,38,8,61],[12,39,8,61,"default"],[12,46,8,61],[12,48,8,61,"_useState"],[12,57,8,61],[13,6,8,9,"status"],[13,12,8,15],[13,15,8,15,"_useState2"],[13,25,8,15],[14,6,8,17,"setStatus"],[14,15,8,26],[14,18,8,26,"_useState2"],[14,28,8,26],[15,4,9,2],[15,8,9,2,"_useState3"],[15,18,9,2],[15,21,9,44],[15,25,9,44,"useState"],[15,40,9,52],[15,42,9,61],[15,61,9,80],[15,62,9,81],[16,6,9,81,"_useState4"],[16,16,9,81],[16,23,9,81,"_slicedToArray2"],[16,38,9,81],[16,39,9,81,"default"],[16,46,9,81],[16,48,9,81,"_useState3"],[16,58,9,81],[17,6,9,9,"statusMessage"],[17,19,9,22],[17,22,9,22,"_useState4"],[17,32,9,22],[18,6,9,24,"setStatusMessage"],[18,22,9,40],[18,25,9,40,"_useState4"],[18,35,9,40],[19,4,10,2],[19,8,10,2,"_useState5"],[19,18,10,2],[19,21,10,34],[19,25,10,34,"useState"],[19,40,10,42],[19,42,10,51],[19,46,10,55],[19,47,10,56],[20,6,10,56,"_useState6"],[20,16,10,56],[20,23,10,56,"_slicedToArray2"],[20,38,10,56],[20,39,10,56,"default"],[20,46,10,56],[20,48,10,56,"_useState5"],[20,58,10,56],[21,6,10,9,"progress"],[21,14,10,17],[21,17,10,17,"_useState6"],[21,27,10,17],[22,6,10,19,"setProgress"],[22,17,10,30],[22,20,10,30,"_useState6"],[22,30,10,30],[23,4,11,2],[23,8,11,2,"_useState7"],[23,18,11,2],[23,21,11,40],[23,25,11,40,"useState"],[23,40,11,48],[23,42,11,69],[24,8,12,4,"version"],[24,15,12,11],[24,17,12,13],[24,19,12,15],[25,8,13,4,"mandatory"],[25,17,13,13],[25,19,13,15],[25,24,13,20],[26,8,14,4,"updateUrl"],[26,17,14,13],[26,19,14,15,"undefined"],[26,28,14,24],[27,8,15,4,"message"],[27,15,15,11],[27,17,15,13],[28,6,16,2],[28,7,16,3],[28,8,16,4],[29,6,16,4,"_useState8"],[29,16,16,4],[29,23,16,4,"_slicedToArray2"],[29,38,16,4],[29,39,16,4,"default"],[29,46,16,4],[29,48,16,4,"_useState7"],[29,58,16,4],[30,6,11,9,"versionInfo"],[30,17,11,20],[30,20,11,20,"_useState8"],[30,30,11,20],[31,6,11,22,"setVersionInfo"],[31,20,11,36],[31,23,11,36,"_useState8"],[31,33,11,36],[32,4,17,2],[32,8,17,8,"mountedRef"],[32,18,17,18],[32,21,17,21],[32,25,17,21,"useRef"],[32,38,17,27],[32,40,17,28],[32,44,17,32],[32,45,17,33],[33,4,19,2],[33,8,19,8,"ensureMinimumDelay"],[33,26,19,26],[33,29,19,29],[33,33,19,29,"useCallback"],[33,51,19,40],[34,6,19,40],[34,10,19,40,"_ref"],[34,14,19,40],[34,21,19,40,"_asyncToGenerator2"],[34,39,19,40],[34,40,19,40,"default"],[34,47,19,40],[34,49,19,41],[34,60,19,48,"startedAt"],[34,69,19,65],[34,71,19,70],[35,8,20,4],[35,12,20,10,"elapsed"],[35,19,20,17],[35,22,20,20,"Date"],[35,26,20,24],[35,27,20,25,"now"],[35,30,20,28],[35,31,20,29],[35,32,20,30],[35,35,20,33,"startedAt"],[35,44,20,42],[36,8,21,4],[36,12,21,10,"wait"],[36,16,21,14],[36,19,21,17,"Math"],[36,23,21,21],[36,24,21,22,"max"],[36,27,21,25],[36,28,21,26],[36,29,21,27],[36,31,21,29,"MIN_LOADING_MS"],[36,61,21,29],[36,62,21,29,"MIN_LOADING_MS"],[36,99,21,43],[36,102,21,46,"elapsed"],[36,109,21,53],[36,110,21,54],[37,8,22,4],[37,12,22,8,"wait"],[37,16,22,12],[37,19,22,15],[37,20,22,16],[37,22,22,18],[38,10,23,6],[38,16,23,12],[38,20,23,16,"Promise"],[38,27,23,23],[38,28,23,24],[38,38,23,24,"resolve"],[38,45,23,31],[39,12,23,31],[39,19,23,35,"setTimeout"],[39,29,23,45],[39,30,23,46,"resolve"],[39,37,23,53],[39,39,23,55,"wait"],[39,43,23,59],[39,44,23,60],[40,10,23,60],[40,12,23,61],[41,8,24,4],[42,6,25,2],[42,7,25,3],[43,6,25,3],[43,23,25,3,"_x"],[43,25,25,3],[44,8,25,3],[44,15,25,3,"_ref"],[44,19,25,3],[44,20,25,3,"apply"],[44,25,25,3],[44,32,25,3,"arguments"],[44,41,25,3],[45,6,25,3],[46,4,25,3],[46,9,25,5],[46,11,25,7],[46,12,25,8],[47,4,27,2],[47,8,27,8,"runCheck"],[47,16,27,16],[47,19,27,19],[47,23,27,19,"useCallback"],[47,41,27,30],[47,60,27,30,"_asyncToGenerator2"],[47,78,27,30],[47,79,27,30,"default"],[47,86,27,30],[47,88,27,31],[47,101,27,43],[48,6,28,4],[48,10,28,10,"startedAt"],[48,19,28,19],[48,22,28,22,"Date"],[48,26,28,26],[48,27,28,27,"now"],[48,30,28,30],[48,31,28,31],[48,32,28,32],[49,6,29,4],[49,10,29,8,"nextStatus"],[49,20,29,30],[49,23,29,33],[49,30,29,40],[50,6,30,4],[50,10,30,8,"nextMessage"],[50,21,30,19],[50,24,30,22],[50,26,30,24],[51,6,31,4],[51,10,31,8,"nextVersionInfo"],[51,25,31,43],[51,28,31,46],[52,8,32,6,"version"],[52,15,32,13],[52,17,32,15],[52,19,32,17],[53,8,33,6,"mandatory"],[53,17,33,15],[53,19,33,17],[53,24,33,22],[54,8,34,6,"updateUrl"],[54,17,34,15],[54,19,34,17,"undefined"],[54,28,34,26],[55,8,35,6,"message"],[55,15,35,13],[55,17,35,15],[56,6,36,4],[56,7,36,5],[57,6,38,4,"setStatus"],[57,15,38,13],[57,16,38,14],[57,25,38,23],[57,26,38,24],[58,6,39,4,"setStatusMessage"],[58,22,39,20],[58,23,39,21],[58,42,39,40],[58,43,39,41],[59,6,40,4,"setProgress"],[59,17,40,15],[59,18,40,16],[59,22,40,20],[59,23,40,21],[60,6,42,4],[60,10,42,10,"outcome"],[60,17,42,38],[60,26,42,47],[60,30,42,47,"checkVersion"],[60,60,42,47],[60,61,42,47,"checkVersion"],[60,101,42,59],[60,103,42,60],[60,104,42,61],[61,6,44,4],[61,10,44,8,"outcome"],[61,17,44,15],[61,18,44,16,"status"],[61,24,44,22],[61,29,44,27],[61,33,44,31],[61,35,44,33],[62,8,45,6,"nextStatus"],[62,18,45,16],[62,21,45,19],[62,28,45,26],[63,8,46,6,"nextMessage"],[63,19,46,17],[63,22,46,20],[63,24,46,22],[64,8,47,6,"nextVersionInfo"],[64,23,47,21],[64,26,47,24,"outcome"],[64,33,47,31],[64,34,47,32,"payload"],[64,41,47,39],[65,6,48,4],[65,7,48,5],[65,13,48,11],[65,17,48,15,"outcome"],[65,24,48,22],[65,25,48,23,"status"],[65,31,48,29],[65,36,48,34],[65,46,48,44],[65,48,48,46],[66,8,49,6,"nextStatus"],[66,18,49,16],[66,21,49,19],[66,30,49,28],[67,8,50,6,"nextMessage"],[67,19,50,17],[67,22,51,8,"outcome"],[67,29,51,15],[67,30,51,16,"payload"],[67,37,51,23],[67,38,51,24,"message"],[67,45,51,31],[67,49,52,8],[67,67,52,26,"outcome"],[67,74,52,33],[67,75,52,34,"payload"],[67,82,52,41],[67,83,52,42,"version"],[67,90,52,49],[67,118,52,77],[68,8,53,6,"nextVersionInfo"],[68,23,53,21],[68,26,53,24,"outcome"],[68,33,53,31],[68,34,53,32,"payload"],[68,41,53,39],[69,6,54,4],[69,7,54,5],[69,13,54,11],[70,8,55,6,"nextStatus"],[70,18,55,16],[70,21,55,19],[70,28,55,26],[71,8,56,6,"nextMessage"],[71,19,56,17],[71,22,57,8],[71,103,57,89],[72,6,58,4],[73,6,60,4],[73,12,60,10,"ensureMinimumDelay"],[73,30,60,28],[73,31,60,29,"startedAt"],[73,40,60,38],[73,41,60,39],[74,6,61,4],[74,10,61,8],[74,11,61,9,"mountedRef"],[74,21,61,19],[74,22,61,20,"current"],[74,29,61,27],[74,31,61,29],[75,8,62,6],[76,6,63,4],[77,6,65,4,"setVersionInfo"],[77,20,65,18],[77,21,65,19,"nextVersionInfo"],[77,36,65,34],[77,37,65,35],[78,6,66,4,"setStatusMessage"],[78,22,66,20],[78,23,66,21,"nextMessage"],[78,34,66,32],[78,35,66,33],[79,6,67,4,"setStatus"],[79,15,67,13],[79,16,67,14,"nextStatus"],[79,26,67,24],[79,27,67,25],[80,6,68,4,"setProgress"],[80,17,68,15],[80,18,68,16],[80,19,68,17],[80,20,68,18],[81,4,69,2],[81,5,69,3],[81,8,69,5],[81,9,69,6,"ensureMinimumDelay"],[81,27,69,24],[81,28,69,25],[81,29,69,26],[82,4,71,2],[82,8,71,2,"useEffect"],[82,24,71,11],[82,26,71,12],[82,38,71,18],[83,6,72,4,"runCheck"],[83,14,72,12],[83,15,72,13],[83,16,72,14],[84,4,73,2],[84,5,73,3],[84,7,73,5],[84,8,73,6,"runCheck"],[84,16,73,14],[84,17,73,15],[84,18,73,16],[85,4,75,2],[85,8,75,2,"useEffect"],[85,24,75,11],[85,26,75,12],[85,38,75,18],[86,6,76,4],[86,10,76,8,"status"],[86,16,76,14],[86,21,76,19],[86,30,76,28],[86,32,76,30],[87,8,77,6],[88,6,78,4],[89,6,80,4],[89,10,80,10,"timer"],[89,15,80,15],[89,18,80,18,"setInterval"],[89,29,80,29],[89,30,80,30],[89,42,80,36],[90,8,81,6,"setProgress"],[90,19,81,17],[90,20,81,18],[90,30,81,18,"prev"],[90,34,81,22],[90,36,81,26],[91,10,82,8],[91,14,82,14,"next"],[91,18,82,18],[91,21,82,21,"prev"],[91,25,82,25],[91,28,82,28],[91,32,82,32],[92,10,83,8],[92,17,83,15,"next"],[92,21,83,19],[92,24,83,22],[92,28,83,26],[92,31,83,29],[92,35,83,33],[92,38,83,36,"next"],[92,42,83,40],[93,8,84,6],[93,9,84,7],[93,10,84,8],[94,6,85,4],[94,7,85,5],[94,9,85,7],[94,12,85,10],[94,13,85,11],[95,6,87,4],[95,13,87,11],[96,8,87,11],[96,15,87,17,"clearInterval"],[96,28,87,30],[96,29,87,31,"timer"],[96,34,87,36],[96,35,87,37],[97,6,87,37],[98,4,88,2],[98,5,88,3],[98,7,88,5],[98,8,88,6,"status"],[98,14,88,12],[98,15,88,13],[98,16,88,14],[99,4,90,2],[99,8,90,2,"useEffect"],[99,24,90,11],[99,26,90,12],[99,38,90,18],[100,6,91,4],[100,13,91,11],[100,25,91,17],[101,8,92,6,"mountedRef"],[101,18,92,16],[101,19,92,17,"current"],[101,26,92,24],[101,29,92,27],[101,34,92,32],[102,6,93,4],[102,7,93,5],[103,4,94,2],[103,5,94,3],[103,7,94,5],[103,9,94,7],[103,10,94,8],[104,4,96,2],[104,11,96,9],[105,6,97,4,"status"],[105,12,97,10],[105,14,97,4,"status"],[105,20,97,10],[106,6,98,4,"statusMessage"],[106,19,98,17],[106,21,98,4,"statusMessage"],[106,34,98,17],[107,6,99,4,"progress"],[107,14,99,12],[107,16,99,4,"progress"],[107,24,99,12],[108,6,100,4,"versionInfo"],[108,17,100,15],[108,19,100,4,"versionInfo"],[108,30,100,15],[109,6,101,4,"appVersion"],[109,16,101,14],[109,18,101,16,"APP_VERSION"],[109,48,101,16],[109,49,101,16,"APP_VERSION"],[109,83,101,27],[110,6,102,4,"retry"],[110,11,102,9],[110,13,102,11,"runCheck"],[111,4,103,2],[111,5,103,3],[112,2,104,0],[113,0,104,1],[113,3]],"functionMap":{"names":["<global>","useVersionGate","ensureMinimumDelay","Promise$argument_0","runCheck","useEffect$argument_0","setInterval$argument_0","setProgress$argument_0","<anonymous>"],"mappings":"AAA;OCM;yCCY;wBCI,oCD;GDE;+BGE;GH0C;YIE;GJE;YIE;8BCK;kBCC;ODG;KDC;WGE,0BH;GJC;YIE;WGC;KHE;GJC;CDU"}},"type":"js/module"}]}